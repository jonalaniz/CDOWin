<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="CDOWin.Views.Clients.ClientViewPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:views="using:CDOWin.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:CDOWin.ViewModels" 
    xmlns:models="using:CDO.Core.Models"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:dialogs="using:CDOWin.Views.Clients.Dialogs"
    xmlns:c="using:CDOWin.Controls"
    mc:Ignorable="d">

    <Grid BorderThickness="0, 0, 1, 0" BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
          Visibility="{x:Bind ViewModel.Selected, Mode=OneWay, Converter={StaticResource NullToVisability}}">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- Row 0: Title + Buttons -->
        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource PageTitleStyle}"
                   Text="{x:Bind ViewModel.Selected.FormattedName, Mode=OneWay}"
                   x:Name="Header" RightTapped="TextBlock_RightTapped"/>

        <!-- CommandBar -->
        <CommandBar Grid.Row="0" Grid.Column="1" DefaultLabelPosition="Collapsed" Background="Transparent">
            
            <!-- Documents Button -->
            <AppBarButton Width="56" Label="Documents" Click="OpenDocuments_Clicked" IsCompact="False" ToolTipService.ToolTip="Open Documents">
                <AppBarButton.Icon>
                    <FontIcon Glyph="&#xE838;" Style="{StaticResource SingleIconFontStyle}"/>
                </AppBarButton.Icon>
            </AppBarButton>
            
            <!-- Reminders Button -->
            <AppBarButton Width="56" Label="New Reminder" Click="CreateReminder_ClickAsync" IsCompact="False" ToolTipService.ToolTip="New Reminder">
                <AppBarButton.Icon>
                    <FontIcon Glyph="&#xED0E;" Style="{StaticResource SingleIconFontStyle}"/>
                </AppBarButton.Icon>
            </AppBarButton>
            
            <!-- Menu Button -->
            <AppBarButton Width="56" IsCompact="False" ToolTipService.ToolTip="More">
                <AppBarButton.Icon>
                    <FontIcon Glyph="&#xE712;" Style="{StaticResource SingleIconFontStyle}"/>
                </AppBarButton.Icon>
                <AppBarButton.Flyout>
                    <MenuFlyout Placement="BottomEdgeAlignedLeft">
                        <MenuFlyoutItem Text="Edit..." Click="EditButton_Clicked" Tag="{x:Bind dialogs:ClientEditType.Administrative}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Edit" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Delete...">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Delete" Foreground="{ThemeResource SystemFillColorCriticalBrush}"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </AppBarButton.Flyout>
            </AppBarButton>
        </CommandBar>

        <!-- Row 1: ScrollViewer + WrapPanel -->
        <ScrollViewer Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2">
            
            <!-- Wrap Panel -->
            <controls:WrapPanel Orientation="Horizontal" Margin="8,0,8,8" HorizontalSpacing="8" VerticalSpacing="8">

                <!-- Personal Information Card-->
                <Grid Style="{StaticResource CardContainerGridStyle}">
                    
                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" Text="Personal Information"
                                       Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}"
                                    Tag="{x:Bind dialogs:ClientEditType.Personal}" Click="EditButton_Clicked"
                                    ToolTipService.ToolTip="Edit">
                                <FontIcon Glyph="&#xE70F;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </Button>
                        </Grid>

                        <!-- Date of Birth/DL/SSN -->
                        <c:LabelPair Grid.Row ="1" Grid.Column="0" Grid.ColumnSpan="2" Label="DOB"
                                     Value="{x:Bind ViewModel.Selected.FormattedDOB, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2" Label="DL/ID"
                                     Value="{x:Bind ViewModel.Selected.DriversLicense, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="1" Grid.Column="4" Grid.ColumnSpan="2" Label="SSN"
                                     Value="{x:Bind ViewModel.Selected.FormattedSSN, Mode=OneWay}"/>

                        <!-- Fluent Languages/Race -->
                        <c:LabelPair Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Label="Fluent Languages"
                                     Value="{x:Bind ViewModel.Selected.FluentLanguages, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="2" Grid.Column="3" Grid.ColumnSpan="3" Label="Race"
                                     Value="{x:Bind ViewModel.Selected.Race, Mode=OneWay}"/>

                        <!-- Address Section -->
                        <c:LabelPair Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="6" Label="Address"
                                     Value="{x:Bind ViewModel.Selected.FormattedAddress, Mode=OneWay}"/>

                        <!-- Education Section -->
                        <c:LabelPair Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="6" Label="Education"
                                     IsValueSelectable="True"
                                     Value="{x:Bind ViewModel.Selected.Education, Mode=OneWay}"/>
                    </Grid>
                </Grid>

                <!-- Contact Information Card -->
                <Grid Style="{StaticResource CardContainerGridStyle}">

                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Contact Information" Style="{StaticResource SubtitleTextBlockStyle}"/>

                            <!-- Edit Contact Information Button -->
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}" 
                                    Tag="{x:Bind dialogs:ClientEditType.Contact}" Click="EditButton_Clicked"
                                    ToolTipService.ToolTip="Edit">
                                <FontIcon Glyph="&#xE70F;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </Button>
                        </Grid>

                        <!-- Phone 1 -->
                        <FontIcon Grid.Row="1" Grid.Column="0" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}" Glyph="&#xE717;"
                                  Visibility="{x:Bind ViewModel.Selected.Phone1, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>
                        <c:LabelPair Grid.Row="1" Grid.Column="1" 
                                     Label="{x:Bind ViewModel.Selected.Phone1Identity, Mode=OneWay}" 
                                     Value="{x:Bind ViewModel.Selected.Phone1, Mode=OneWay}" 
                                     Visibility="{x:Bind ViewModel.Selected.Phone1, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>

                        <!-- Phone 2 -->
                        <c:LabelPair Grid.Row="2" Grid.Column="1"
                                     Label="{x:Bind ViewModel.Selected.Phone2Identity, Mode=OneWay}" 
                                     Value="{x:Bind ViewModel.Selected.Phone2, Mode=OneWay}"
                                     Visibility="{x:Bind ViewModel.Selected.Phone2, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>

                        <!-- Phone 3 -->
                        <c:LabelPair Grid.Row="3" Grid.Column="1"
                                     Label="{x:Bind ViewModel.Selected.Phone3Identity, Mode=OneWay}" 
                                     Value="{x:Bind ViewModel.Selected.Phone3, Mode=OneWay}"
                                     Visibility="{x:Bind ViewModel.Selected.Phone3, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>

                        <!-- Email 1 -->
                        <FontIcon Grid.Row="4" Grid.Column="0" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}" Glyph="&#xE715;" 
                                  Visibility="{x:Bind ViewModel.Selected.Email, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>

                        <c:LabelPair Grid.Row="4" Grid.Column="1"
                                     Label="{x:Bind ViewModel.Selected.EmailIdentity, Mode=OneWay}" 
                                     Value="{x:Bind ViewModel.Selected.Email, Mode=OneWay}"
                                     Visibility="{x:Bind ViewModel.Selected.Email, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>

                        <!-- Email 2 -->
                        <c:LabelPair Grid.Row="5" Grid.Column="1"
                                     Label="{x:Bind ViewModel.Selected.Email2Identity, Mode=OneWay}" 
                                     Value="{x:Bind ViewModel.Selected.Email2, Mode=OneWay}"
                                     Visibility="{x:Bind ViewModel.Selected.Email2, Mode=OneWay, Converter={StaticResource StringToVisability}}"/>
                    </Grid>
                </Grid>

                <!-- Case Information Card -->
                <Grid Style="{StaticResource CardContainerGridStyle}">
                    
                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Case Information" Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}" ToolTipService.ToolTip="Edit"
                                    Tag="{x:Bind dialogs:ClientEditType.Case}" Click="EditButton_Clicked">
                                <FontIcon Glyph="&#xE70F;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </Button>
                        </Grid>

                        <!-- Start Date/Case ID/Tier Section -->
                        <c:LabelPair Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Label="Start Date" 
                                     Value="{x:Bind ViewModel.Selected.FormattedStartDate, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2" Label="Case ID" 
                                     Value="{x:Bind ViewModel.Selected.CaseID, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="1" Grid.Column="4" Grid.ColumnSpan="2" Label="Tier" 
                                     Value="{x:Bind ViewModel.Selected.Status, Mode=OneWay}"/>

                        <!-- Benefits/Premiums Section -->
                        <c:LabelPair Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Label="Benefits" 
                                     Value="{x:Bind ViewModel.Selected.Benefits, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="2" Grid.Column="2" Grid.ColumnSpan="4" Label="Premiums" 
                                     Value="{x:Bind ViewModel.Selected.Premiums, Mode=OneWay}"/>

                        <!-- Counselor Section -->
                        <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="6"  
                                    Visibility="{x:Bind ViewModel.Selected.CounselorReference, Mode=OneWay, Converter={StaticResource StringToVisability}}">
                            <TextBlock Style="{StaticResource LabelTextBlockStyle}" Text="Counselor"/>
                            <TextBlock Style="{StaticResource ValueTextBlockStyle}" IsTextSelectionEnabled="True"
                                       Text="{x:Bind ViewModel.Selected.CounselorReference.Name, Mode=OneWay}"/>
                            <TextBlock Style="{StaticResource ValueTextBlockStyle}" IsTextSelectionEnabled="True"
                                       Text="{x:Bind ViewModel.Selected.CounselorReference.Phone, Mode=OneWay}"/>
                            <TextBlock Style="{StaticResource ValueTextBlockStyle}" IsTextSelectionEnabled="True"
                                       Text="{x:Bind ViewModel.Selected.CounselorReference.Email, Mode=OneWay}"/>
                        </StackPanel>

                        <!-- Secretary Section -->
                        <StackPanel Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="6"
                                    Visibility="{x:Bind ViewModel.Selected.CounselorReference, Mode=OneWay, Converter={StaticResource StringToVisability}}">
                            <TextBlock Style="{StaticResource LabelTextBlockStyle}" Text="Secretary"/>
                            <TextBlock Style="{StaticResource ValueTextBlockStyle}" IsTextSelectionEnabled="True"
                                       Text="{x:Bind ViewModel.Selected.CounselorReference.SecretaryName, Mode=OneWay}"/>
                            <TextBlock Style="{StaticResource ValueTextBlockStyle}" IsTextSelectionEnabled="True"
                                       Text="{x:Bind ViewModel.Selected.CounselorReference.SecretaryEmail, Mode=OneWay}"/>
                        </StackPanel>
                    </Grid>
                </Grid>

                <!-- Conditions Card -->
                <Grid Style="{StaticResource CardContainerGridStyle}">

                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Conditions"
                                       Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}"
                                    Tag="{x:Bind dialogs:ClientEditType.Conditions}" Click="EditButton_Clicked"
                                    ToolTipService.ToolTip="Edit">
                                <FontIcon Glyph="&#xE70F;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </Button>
                        </Grid>

                        <!-- Start Date/Case ID/Status Section -->
                        <c:LabelPair Grid.Row="1" Grid.Column="0" Label="Employment Goals" IsValueSelectable="True"
                                     Value="{x:Bind ViewModel.Selected.EmploymentGoal, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="2" Grid.Column="0" Label="Conditions" IsValueSelectable="True"
                                      Value="{x:Bind ViewModel.Selected.Conditions, Mode=OneWay}"/>
                    </Grid>
                </Grid>

                <!-- Service Authorizations Card -->
                <Grid Style="{StaticResource CardContainerGridStyle}">
                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}" Margin="12,6,6,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Service Authorizations" Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}"
                                    Click="CreateSA_Click" ToolTipService.ToolTip="New Service Authorization">
                                <FontIcon Glyph="&#xE710;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </Button>
                        </Grid>
                        
                        <!-- Item Repeater -->
                        <ScrollViewer Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,4,0">
                            <ItemsRepeater ItemsSource="{x:Bind ViewModel.Invoices, Mode=OneWay}">
                                <DataTemplate x:DataType="models:Invoice">

                                    <!-- Button -->
                                    <Button Margin="0,0,0,6" Click="SA_Click" Tag="{x:Bind Id}"
                                            HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                            BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}">
                                        <StackPanel Spacing="2">
                                            <TextBlock FontWeight="Bold" Text="{x:Bind ServiceAuthorizationNumber}"/>
                                            <TextBlock Text="{x:Bind Description}"/>
                                            <TextBlock Text="{x:Bind FormattedDateRange}"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsRepeater>
                        </ScrollViewer>
                    </Grid>
                </Grid>

                <!-- Employment Profile Card -->
                <Grid Style="{StaticResource CardContainerGridStyle}">

                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Employment Profile"
                                       Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}"
                                    Tag="{x:Bind dialogs:ClientEditType.Employment}" Click="EditButton_Clicked"
                                    ToolTipService.ToolTip="Edit">
                                <FontIcon Glyph="&#xE70F;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"/>
                            </Button>
                        </Grid>
                        <!-- Start Date/Case ID/Status Section -->
                        <c:LabelPair Grid.Row="1" Grid.Column="0" Label="Disability" 
                                     Value="{x:Bind ViewModel.Selected.Disability, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="2" Grid.Column="0" Label="Criminal Charges" 
                                     Value="{x:Bind ViewModel.Selected.CriminalCharge, Mode=OneWay}"/>

                        <c:LabelPair Grid.Row="3" Grid.Column="0" Label="Transportation" 
                                     Value="{x:Bind ViewModel.Selected.Transportation, Mode=OneWay}"/>
                    </Grid>
                </Grid>

                <!-- Placements Card -->
                <Grid Style="{StaticResource CardContainerGridStyle}">
                    <!-- Inner Grid -->
                    <Grid Style="{StaticResource CardInnerGridStyle}" Margin="12,6,6,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Placements"
                                       Style="{StaticResource SubtitleTextBlockStyle}"/>
                            <Button Grid.Column="1" Style="{StaticResource SubtleButtonStyle}"
                                    Click="CreatePlacement_Click">
                                <FontIcon Glyph="&#xE710;" FontSize="16" Foreground="{ThemeResource AccentAAFillColorDefaultBrush}"
                                          ToolTipService.ToolTip="New Placement"/>
                            </Button>
                        </Grid>

                        <!-- Item Repeater -->
                        <ScrollViewer Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,4,0">
                            <ItemsRepeater ItemsSource="{x:Bind ViewModel.Placements, Mode=OneWay}">
                                <DataTemplate x:DataType="models:Placement">

                                    <!-- Button -->
                                    <Button Margin="0,0,0,6" Click="Placement_Click" Tag="{x:Bind Id}"
                                            HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                            BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}">
                                        <StackPanel Spacing="2">
                                            <TextBlock FontWeight="Bold" Text="{x:Bind Employer.Name}"/>
                                            <TextBlock Text="{x:Bind Employer.Phone}"/>
                                            <TextBlock Text="{x:Bind Position}"/>
                                            <TextBlock Text="{x:Bind FormattedHireDate}"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsRepeater>
                        </ScrollViewer>
                    </Grid>
                </Grid>

                <!-- Checklist Card-->
                <Grid Style="{StaticResource CardContainerGridStyle}">
                    
                    <!-- Inner Grid -->
                    <Grid Margin="12,6,12,6" Style="{StaticResource ChecklistsCardInnerGridStyle}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Header -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                   Margin="0,1,0,5" Text="Checklists"
                                   Style="{StaticResource SubtitleTextBlockStyle}"/>
                        
                        <!-- Resume Section -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Resume" FontWeight="Bold"/>
                        <CheckBox Grid.Row="2" Grid.Column="0" Style="{StaticResource LeftCheckboxStyle}"
                                  Content="Required" Tag="{x:Bind dialogs:CheckboxTag.ResumeRequired}"
                                  IsChecked="{x:Bind ViewModel.Selected.ResumeRequired, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>
                        <CheckBox Grid.Row="2" Grid.Column="1" Style="{StaticResource RightCheckboxStyle}"
                                  Content="Completed" Tag="{x:Bind dialogs:CheckboxTag.ResumeCompleted}"
                                  IsChecked="{x:Bind ViewModel.Selected.ResumeCompleted, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>

                        <!-- Video Interviews Section -->
                        <TextBlock Grid.Row="3" Grid.Column="0"
                                   Text="Video Interviews"
                                   FontWeight="Bold"/>
                        <CheckBox Grid.Row="4" Grid.Column="0" Style="{StaticResource LeftCheckboxStyle}"
                                  Content="Required" Tag="{x:Bind dialogs:CheckboxTag.VideoInterviewRequired}"
                                  IsChecked="{x:Bind ViewModel.Selected.VideoInterviewRequired, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>
                        <CheckBox Grid.Row="4" Grid.Column="1" Style="{StaticResource RightCheckboxStyle}"
                                  Content="Completed" Tag="{x:Bind dialogs:CheckboxTag.VideoInterviewCompleted}"
                                  IsChecked="{x:Bind ViewModel.Selected.VideoInterviewCompleted, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>

                        <!-- Releases Section -->
                        <TextBlock Grid.Row="5" Grid.Column="0" VerticalAlignment="Center"
                                   Text="Releases" FontWeight="Bold"/>
                        <CheckBox Grid.Row="5" Grid.Column="1" Style="{StaticResource RightCheckboxStyle}"
                                  Content="Completed" Tag="{x:Bind dialogs:CheckboxTag.ReleasesCompleted}"
                                  IsChecked="{x:Bind ViewModel.Selected.ReleasesCompleted, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>

                        <!-- Orientation Section -->
                        <TextBlock Grid.Row="6" Grid.Column="0" VerticalAlignment="Center"
                                   Text="Orientation" FontWeight="Bold"/>
                        <CheckBox Grid.Row="6" Grid.Column="1" Style="{StaticResource RightCheckboxStyle}"
                                  Content="Completed" Tag="{x:Bind dialogs:CheckboxTag.OrientationCompleted}"
                                  IsChecked="{x:Bind ViewModel.Selected.OrientationCompleted, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>

                        <!-- 1850 Data Sheet Section -->
                        <TextBlock Grid.Row="7"  Grid.Column="0" VerticalAlignment="Center"
                                   Text="1850 Data Sheet" FontWeight="Bold"/>
                        <CheckBox Grid.Row="7"  Grid.Column="1" Style="{StaticResource RightCheckboxStyle}"
                                  Content="Completed" Tag="{x:Bind dialogs:CheckboxTag.DataSheetCompleted}"
                                  IsChecked="{x:Bind ViewModel.Selected.DataSheetCompleted, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>

                        <!-- Elevator Speech Section -->
                        <TextBlock Grid.Row="8" Grid.Column="0" VerticalAlignment="Center"
                                   Text="Elevator Speech" FontWeight="Bold"/>
                        <CheckBox Grid.Row="8" Grid.Column="1" Style="{StaticResource RightCheckboxStyle}"
                                  Content="Completed" Tag="{x:Bind dialogs:CheckboxTag.ElevatorSpeechCompleted}"
                                  IsChecked="{x:Bind ViewModel.Selected.ElevatorSpeechCompleted, Mode=OneWay}"
                                  Click="Checkbox_Clicked"/>
                    </Grid>
                </Grid>
            </controls:WrapPanel>
        </ScrollViewer>
    
        <!-- Row 2: Status Bar -->
        <Grid Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" 
              Background="{ThemeResource LayerOnMicaBaseAltFillColorDefaultBrush}">
            <StackPanel Orientation="Horizontal" Spacing="8" 
                        VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Style="{StaticResource PageSubtitleStyle}" Margin="0">
                    <Run Text="ACE ID:"/>
                    <Run Text="{x:Bind ViewModel.Selected.Id, Mode=OneWay}"/>
                </TextBlock>
                <TextBlock Text="TTW" FontWeight="Bold" Visibility="{x:Bind ViewModel.Selected.TTW, Mode=OneWay, Converter={StaticResource BoolVisibilityConverter}}"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
