<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="CDOWin.Views.Reminders.RemindersPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:CDOWin.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:CDOWin.ViewModels" 
    xmlns:models="using:CDO.Core.Models"
    xmlns:reminders="using:CDOWin.Views.Reminders"
    d:DataContext="{d:DesignInstance Type=viewmodels:RemindersViewModel}"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Margin="8,8,8,4"
                   Style="{StaticResource PageTitleStyle}"
                   Text="Reminders"/>

        <CalendarView Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,6,0,0"
                      x:Name="RemindersCalendar" HorizontalAlignment="Center" SelectionMode="Single"
                      IsGroupLabelVisible="True" IsOutOfScopeEnabled="True" 
                      SelectedDatesChanged="RemindersCalendar_SelectedDatesChanged"
                      CalendarViewDayItemChanging="RemindersCalendar_CalendarViewDayItemChanging"
                      CalendarIdentifier="GregorianCalendar"/>

        <!-- Selection Bar: Used to filter our reminders -->
        <SelectorBar Grid.Row="2" Grid.Column="0" x:Name="SelectionBar" SelectionChanged="SelectionChanged">
            <SelectorBarItem Text="All" IsSelected="True" Tag="{x:Bind reminders:RemindersFilter.All}"/>
            <SelectorBarItem Text="Upcoming" Tag="{x:Bind reminders:RemindersFilter.Upcoming}"/>
            <SelectorBarItem Text="Client" IsEnabled="False" Tag="{x:Bind reminders:RemindersFilter.Client}"/>
            <SelectorBarItem Text="Selected" IsEnabled="True" Tag="{x:Bind reminders:RemindersFilter.Date}"/>
        </SelectorBar>

        <Button Grid.Row="2" Grid.Column="2" Margin="8,4,8,0"
                Style="{StaticResource SingleIconButtonStyle}"
                Click="NewReminder_Clicked">
            <FontIcon Glyph="&#xF763;" Style="{StaticResource SingleIconFontStyle}"/>
        </Button>

        <ScrollViewer Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <ItemsRepeater Grid.Row="0" ItemsSource="{Binding Filtered}" HorizontalAlignment="Stretch">
                    <ItemsRepeater.ItemTemplate>
                        <DataTemplate x:DataType="models:Reminder">
                            <SplitButton Margin="8,6,8,0" Padding="14,10,14,10" Click="Reminder_Click"
                                         Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                         HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                                         BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                                         Tag="{x:Bind clientID}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>

                                    <Grid Grid.Row="0" Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" FontSize="14" 
                                                   FontWeight="Bold" Text="{x:Bind clientName}"/>
                                        <TextBlock Grid.Column="1" FontSize="14" 
                                                   FontWeight="Normal" Text="{x:Bind localDate}"/>
                                    </Grid>

                                    <TextBlock Grid.Row="1" Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               FontWeight="Normal" TextWrapping="WrapWholeWords" 
                                               Text="{x:Bind description}"/>
                                </Grid>
                            </SplitButton>
                        </DataTemplate>
                    </ItemsRepeater.ItemTemplate>
                </ItemsRepeater>
                <TextBlock Grid.Row="1" Margin="8,8,8,24" HorizontalAlignment="Center"
                           x:Name="EndTextField"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           Text="{x:Bind ViewModel.EndText, Mode=OneWay}"/>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>
